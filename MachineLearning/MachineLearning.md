# Machine Learning

# κ°μ”

## κ°μ”

- λ°μ΄ν„°μ—μ„ μ§€μ‹μ„ μ¶”μ¶ν•λ” μ‘μ—…
- μ½”λ”©ν•μ§€ μ•κ³  μμ λ¥Ό ν†µν•΄ ν•™μµν•  μ μλ” μ‹μ¤ν…
- κ²½ν—μ„ ν†µν•΄ λ°μ΄ν„° κΈ°λ°μΌλ΅ ν•™μµν•κ³  μμΈ΅
- λ°μ΄ν„°λ΅λ¶€ν„° μ μ©ν• κ·μΉ™ λ“±μ„ μ¶”μ¶ν•λ” κΈ°λ¥

## ν•™μµ κ°λ…

- κ°„λ‹¨ν• μ
    
    μ…λ ¥κ³Ό μ¶λ ¥μ΄ μ—¬λ¬ κ°μ λ°μ΄ν„° μμΌλ΅ μ£Όμ–΄μ§.
    
    (1,2), (2,4), (4,8) β€¦
    
    ν•™μµ ν›„ μ¶λ ¥μ΄ μ…λ ¥μ 2λ°°μ„μ„ μ μ¶”
    
    (3,?), (8,?) β‡’ 6, 16 λ“±μΌλ΅ λ‹µλ³€
    

## λ¨Έμ‹ λ¬λ‹κ³Ό ν”„λ΅κ·Έλλ°μ μ°¨μ΄μ 

- ν”„λ΅κ·Έλλ°μ—μ„λ” λ¨λ“  κ·μΉ™λ“¤μ„ μ‘μ„±ν•¨
β†’ λ§μ•½ κ·μΉ™λ“¤μ΄ μ¶”κ°€λ΅ μ‘μ„±λ  κ²½μ° μ μ§€ κ΄€λ¦¬κ°€ μ–΄λ ¤μ›€
κ·Έλ¬λ‚ λ¨Έμ‹ λ¬λ‹μ€ μ‹κ°„μ— λ”°λΌ μ μ°¨ ν¨μ¨μ΄ ν–¥μƒλ¨
- μ…μ¶λ ¥ λ°μ΄ν„°μ κ΄€κ³„λ¥Ό ν•™μµν•μ—¬ κ·μΉ™μ„ μƒμ„±
- ν”„λ΅κ·Έλλ°μ—μ„λ” λ°μ΄ν„°μ™€ κ·μΉ™μ΄ κ²°ν•©ν•μ—¬ μ¶λ ¥μ„ μƒμ„±
κ·Έλ¬λ‚ λ¨Έμ‹ λ¬λ‹μ—μ„λ” λ°μ΄ν„°μ™€ μ¶λ ¥μ΄ ν•¨κ» λ“¤μ–΄κ°€μ„ κ·μΉ™ μƒμ„±
    
    ![Untitled](Machine%20Learning%201bf9420c06824cc1bdabb2497ca8765d/Untitled.png)
    

## λ¨Έμ‹ λ¬λ‹κ³Ό μΈκ³µμ§€λ¥κ³Όμ κ΄€κ³„

- λ¨Έμ‹ λ¬λ‹μ€ μΈκ³µμ§€λ¥μ— μ†ν•λ” λ¶€λ¶„ μ§‘ν•©
- μ¶”κµ¬ν•λ” κ°λ…κ³Ό λ©ν‘κ°€ λ‹¤μ† λ‹¤λ¦„
- μΈκ³µμ§€λ¥μ€ μ¶”λ΅ , κ³„ν λ“±κ³Ό λ¨Έμ‹ λ¬λ‹μ„ ν¬ν•¨

![Untitled](Machine%20Learning%201bf9420c06824cc1bdabb2497ca8765d/Untitled%201.png)

- λ¨Έμ‹ λ¬λ‹μ€ λ°μ΄ν„°λ΅λ¶€ν„° ν•™μµν•μ—¬ μ§€μ‹μ„ νλ“
- μΈκ³µμ§€λ¥μ€ μ§€μ‹μ„ νλ“ν• ν›„ κ·Έκ²ƒμ„ ν™μ©
    
    
    |  | λ¨Έμ‹ λ¬λ‹ | μΈκ³µμ§€λ¥ |
    | --- | --- | --- |
    | μ£Όμ” ν™λ™ | ν•™μµμ„ ν†µν• μ§€μ‹μ νλ“ | μ§€μ‹μ νλ“κ³Ό ν™μ© |
    | κµ¬ν„κ³Ό μ‹¤ν„ | λ°μ΄ν„°λ΅λ¶€ν„°μ ν•™μµ μ‹¤ν„ | λ³µμ΅ν• λ¬Έμ  ν•΄κ²°μ„ μ„ν• μ§€λ¥μ κµ¬ν„ |
    | κ°λ° λ©ν‘ | μ¤μ¤λ΅ ν•™μµν•λ” μ•κ³ λ¦¬μ¦ | μΈκ°„μ„ λ‹®μ€ μ§€λ¥μ μΈ μ‹μ¤ν…μ κ°λ° |

## λ¨Έμ‹ λ¬λ‹ κ³Όμ •μ—μ„μ κ³ λ ¤ μ‚¬ν•­

- μ£Όμ–΄μ§„ λ°μ΄ν„°λ΅λ¶€ν„° μ›ν•λ” λ‹µμ„ μ°Ύμ„ μ μμ„κΉ?
- λ¬Έμ  ν•΄κ²°μ„ μ„ν•΄ λ°μ΄ν„°κ°€ μ¶©λ¶„ν•κ°€?
- μ–΄λ–¤ λ¨Έμ‹ λ¬λ‹ κΈ°λ²•μ„ μ μ©ν•λ©΄ μΆ‹μ„κΉ?
- μ¶”μ¶ν•  λ°μ΄ν„°μ νΉμ„±μ€ λ¬΄μ—‡μΈκ°€?
- λ¨Έμ‹ λ¬λ‹μ κ²°λ΅ μ€ λ¬΄μ—‡μΌλ΅ μ„¤μ •ν•  κ²ƒμΈκ°€?
- μƒμ„±λ μ¶λ ¥μ„ μ‹¤μ  μ‘μ©μ— μ–΄λ–»κ² μ‚¬μ©ν•  κ²ƒμΈκ°€?

## λ¨Έμ‹ λ¬λ‹μ μ£Όμ” μΆ…λ¥

- μ‹ κ²½λ§(Neural Network) : μƒλ¬Όμ μ‹ κ²½ λ„¤νΈμ›ν¬ κµ¬μ΅°μ™€ κΈ°λ¥μ„ λ¨λ°©ν• λ¨λΈ
- ν΄λ¬μ¤ν„°λ§(Clustering) : μ£Όμ–΄μ§„ λ°μ΄ν„°λ¥Ό ν΄λ¬μ¤ν„°λΌλ” λ¶€λ¶„ μ§‘ν•©λ“¤λ΅ λ¶„λ¦¬
- λ¶„λ¥(Classification) : μ£Όμ–΄μ§„ λ°μ΄ν„°λ¥Ό λΉ„μ·ν• κ²ƒλ“¤λΌλ¦¬ λ¶„λ¥
- μμ‚¬κ²°μ • νΈλ¦¬(Decision Tree) : νΈλ¦¬ κµ¬μ΅° ν•νƒμ μμΈ΅ λ¨λΈλ΅ μμ‚¬λ¥Ό κ²°μ •
- λ‚μ΄λΈ λ² μ΄μ¦(Naive Bayes) : λ² μ΄μ¦ μ •λ¦¬λ¥Ό λ°”νƒ•μΌλ΅ ν• μ΅°κ±΄λ¶€ ν™•λ¥  λ¨λΈ λ¶„λ¥

# λ¨Έμ‹ λ¬λ‹μ ν•™μµ λ°©λ²•

## λ¨Έμ‹ λ¬λ‹μ ν•™μµ λ°©λ²•

- ν•™μµ ν•νƒμ— λ”°λΌ 3κ°€μ§€ ν•™μµ λ°©λ²•μ΄ μλ‹¤.
- μ§€λ„ ν•™μµ, λΉ„μ§€λ„ ν•™μµ, κ°•ν™” ν•™μµμΌλ΅ κµ¬λ¶„
    
    ![Untitled](Machine%20Learning%201bf9420c06824cc1bdabb2497ca8765d/Untitled%202.png)
    
- λ¨Έμ‹ λ¬λ‹μ ν•™μµ λ°©λ²•κ³Ό ν™μ© λ¶„μ•Ό μ²΄κ³„
    
    ![Untitled](Machine%20Learning%201bf9420c06824cc1bdabb2497ca8765d/Untitled%203.png)
    

## μ§€λ„ ν•™μµ

### **μ§€λ„ν•™μµμ΄λ€?**

- **μ •λ‹µμ΄ μλ” λ°μ΄ν„°**λ¥Ό ν™μ©ν•΄ λ°μ΄ν„°λ¥Ό ν•™μµ
- μ…λ ¥ κ°’(X data)μ΄ μ£Όμ–΄μ§€λ©΄ μ…λ ¥κ°’μ— λ€ν• Label(Y data)λ¥Ό μ£Όμ–΄ ν•™μµ
- λ€ν‘μ μΌλ΅ λ¶„λ¥, νκ·€ λ¬Έμ κ°€ μλ‹¤.

### **μ§€λ„ν•™μµμ μ¥λ‹¨μ **

- **μ¥μ **
    - μ΄μ „μ κ²½ν—μΌλ΅λ¶€ν„° λ°μ΄ν„° μ¶λ ¥μ„ μƒμ„±
    - μ„±λ¥ κΈ°μ¤€μ„ μµμ ν™”
    - λ‹¤μ–‘ν• μ ν•μ λ¬Έμ  ν•΄κ²°μ— λ„μ›€μ΄ λ¨
- **λ‹¨μ **
    - μ¶λ ¥μ— λ°λ“μ‹ λ μ΄λΈ”μ΄ μλ” λ°μ΄ν„°λ“¤μ„ μ‚¬μ©ν•΄μ•Ό ν•¨.
    - μΌλ°μ μΌλ΅ λ§μ€ μ‹κ°„μ΄ κ±Έλ¦Ό

### **λ¶„λ¥(classification)**

- μ£Όμ–΄μ§„ λ°μ΄ν„°λ¥Ό μ •ν•΄μ§„ μΉ΄ν…κ³ λ¦¬(λΌλ²¨)μ— λ”°λΌ λ¶„λ¥ν•λ” λ¬Έμ 
- λ§λ‹¤, μ•„λ‹λ‹¤ λ“±μΒ **μ΄μ§„ λ¶„λ¥ λ¬Έμ **Β λλ” μ‚¬κ³Όλ‹¤ λ°”λ‚λ‚λ‹¤ ν¬λ„λ‹¤ λ“±μ 2κ°€μ§€ μ΄μƒμΌλ΅ λ¶„λ¥ν•λ”Β **λ‹¤μ¤‘ λ¶„λ¥ λ¬Έμ **
- ex) μ¤νΈλ©”μΌ λ¶„λ¥, μ΄λ―Έμ§€ λ¶„λ¥, μ†μΌλ΅ μ“΄ μ£Όμ† νλ³„, μΆ…μ–‘ μ—¬λ¶€ νλ‹¨

### **μ£Όμ” λ¶„λ¥ λ°©λ²•**

- **Naive Bayes λ¶„λ¥κΈ°**
    - μλ£μ λ¶„λ¥λ¥Ό λ² μ΄μ¦ μ •λ¦¬λ¥Ό ν™μ©ν•μ—¬ νλ‹¨γ„΄
    - λ‚μ΄λΈ λ² μ΄μ¦ λ¶„λ¥κΈ°λ” μ΅°κ±΄λ¶€ ν™•λ¥  λ¨λΈ
    - λ¨λ“  νΉμ„±κ°’μ€ μ„λ΅ λ…λ¦½μ΄λΌκ³  κ°€μ •
    - κµ¬μ¶•μ΄ μ‰½κ³  λ€κ·λ¨ λ°μ΄ν„°μ…‹μ— μ μ©
    - μ§€λ„ ν•™μµ ν™κ²½μ—μ„ ν¨μ¨μ μΌλ΅ ν›λ ¨λ  μ μμ
- **μμ‚¬κ²°μ • νΈλ¦¬(Decision Tree)**
    - κ΄€μΈ΅κ°’κ³Ό λ©ν‘κ°’μ„ μ—°κ²°ν•λ” μμΈ΅ λ¨λΈ
    - μµλ€ 2κ°€μ§€μ νλ‹¨μ„ ν•λ” μ΄μ§„ νΈλ¦¬ μ‚¬μ©
    - μ¤λ¬΄κ³ κ° λ¬Έλ‹µμ²λΌ μ„ νƒ λ°©λ²•μΌλ΅ μ§„ν–‰
    - μ£Όνƒμ΄λ‚ μλ™μ°¨ κµ¬μ… λΉ„μ© λ“±μ μ¶”μ •μ— ν™μ©
- **SVM(Support Vector Machine : SVM)**
    - λ°μ΄ν„°λ¥Ό 2κ°μ μμ—­μΌλ΅ λ¶„λ¥ν•λ” μ΄μ§„ λ¶„λ¥κΈ°
    - μƒλ΅μ΄ λ°μ΄ν„°κ°€ μ–΄λ μμ—­μ— μ†ν•λ”μ§€λ¥Ό νλ‹¨
    - κ°€μ¥ ν° ν­μ„ κ°€μ§„ ν•λ‚μ κ²½κ³„μ„ μ„ μ°Ύλ” μ•κ³ λ¦¬μ¦
    - λ¶„λ¥, νκ·€, λ©€ν‹°λ―Έλ””μ–΄ μ •λ³΄ κ²€μƒ‰ λ“±μ— μ‚¬μ©
- **K-Nearest Neighbor(K-NN)**
    - κ°„λ‹¨ν• λ¶„λ¥ κΈ°λ²•
    - μµκ·Όμ ‘ μ΄μ›ƒ λ¶„λ¥λΌκ³ λ„ λ¶λ¦Ό
    - κ°€μ¥ κ°€κΉμ΄ κ²ƒλ“¤κ³Όμ κ±°λ¦¬ κ³„μ‚°μΌλ΅ ν΄λμ¤ λ¶„λ¥
    - μ΄μ›ƒ λ°μ΄ν„°λ“¤μ ν΄λμ¤ μ¤‘ λ‹¤μκ²°λ΅ λ°μ΄ν„°μ ν΄λμ¤ κ²°μ •
    - λ‹¤μκ²°μ—μ„ κ²°κ³Όκ°€ λ‚μ¤κΈ° μ„ν•΄ kλ” λ°λ“μ‹ ν™€μμ—¬μ•Ό ν•¨.
    - μν™”λ‚ μμ•… μ¶”μ²μ— λ€ν• κ°μΈλ³„ μ„ νΈ μμΈ΅
    - μ–Όκµ΄μΈμ‹
    - μ§λ³‘μ μ§λ‹¨κ³Ό μ μ „μ λ°μ΄ν„° μΈμ‹
    - μ¬μ • μ„ν—μ„± νμ•…, μ£Όμ‹ μ‹μ¥ μμΈ΅

### **νκ·€(regression)**

- μ–΄λ–¤ λ°μ΄ν„°λ“¤μ Featureλ¥Ό κΈ°μ¤€μΌλ΅, μ—°μ†λ κ°’(κ·Έλν”„)μ„ μμΈ΅ν•λ” λ¬Έμ 
- μ£Όλ΅ μ–΄λ–¤ ν¨ν„΄μ΄λ‚ νΈλ λ“, κ²½ν–¥μ„ μμΈ΅ν•  λ• μ‚¬μ©
- ν•λ‚μ λ…λ¦½ λ³€μλ¥Ό μ‚¬μ©ν•λ” μ§μ„  ν•νƒμ β€μ„ ν• νκ·€β€™
- νκ·€ λ¶„μ„
    - λ³€μ μ‚¬μ΄μ νκ·€μ— λ€ν•΄ κ²€μ •μ΄λ‚ μ¶”μ •
    - ν•™μµ λ°μ΄ν„°λ¥Ό μ‚¬μ©ν•μ—¬ μ¶λ ¥κ°’ μμΈ΅
    - μ‚°μ¶λ¬Όμ€ ν•­μƒ ν™•λ¥ λ΅ μ  μλ―Έλ¥Ό λ‚΄ν¬
- ex) λ‚ μ”¨ μμΈ΅, νλ§¤μ•΅ μμΈ΅, μ£Όνƒ κ°€κ²© μμΈ΅, μ›μ  κ°€κ²© μ¶”μ •

### **λ¶„λ¥μ™€ νκ·€μ μ°¨μ΄μ **

- λ¶„λ¥λ” μΌμ •ν• κΈ°μ¤€μ— λ”°λΌ λ…λ°±ν•κ² κµ¬λ¶„ μ§“λ” κ²ƒ
- νκ·€λ” μ¤μ°¨ μ κ³±μ ν•©μ„ μµμ†ν™”ν•λ” μ§μ„ μ„ κΈ‹λ” μ‘μ—…
(λ…ν™•ν μ§μ„ μΌλ΅ κµ¬λ³„λλ” κ²ƒμ΄ μ•„λ‹)
- μ¶λ ¥κ°’ μ°¨μ΄
    - λ¶„λ¥ : λ‚¨μ/μ—¬μ λ“± μ„ νƒμ‹ μ¶λ ¥ & β€λ‚΄μΌ λ‚ μ”¨λ” λ¥λ‹¤β€μ™€ κ°™μ΄ μ΄λ¶„λ²•μ  μ„ νƒ
    - νκ·€ : μ—°μ†κ°’μΌλ΅ λ‚νƒ€λƒ„. β€λ‚΄μΌ κΈ°μ¨?β€μ— λ€ν•΄ β€18.3λ„λ΅ μ¶”μ •β€μΌλ΅ μ¶λ ¥

## λΉ„μ§€λ„ ν•™μµ

- μ¶λ ¥κ°’μ„ μ•λ ¤μ£Όμ§€ μ•κ³  μ¤μ¤λ΅ λ¨λΈμ„ κµ¬μ¶•ν•μ—¬ ν•™μµ
- **μ •λ‹µ λΌλ²¨μ΄ μ—†λ” λ°μ΄ν„°**λ¥Ό λΉ„μ·ν• νΉμ§•λΌλ¦¬ **κµ°μ§‘ν™”** ν•μ—¬ μƒλ΅μ΄ λ°μ΄ν„°μ— λ€ν• κ²°κ³Όλ¥Ό μμΈ΅ν•λ” λ°©λ²•
- μ…λ ¥λ§ μκ³  μ¶λ ¥(Label)μ΄ μ—†μ
- κ·μΉ™μ„±μ„ μ¤μ¤λ΅ μ°Ύμ•„λ‚΄λ” κ²ƒμ΄ ν•™μµμ μ£Ό λ©ν‘
- μ§€λ„ ν•™μµμ—μ„ μ μ ν• ν”Όμ²λ¥Ό μ°Ύμ•„λ‚΄κΈ° μ„ν• μ „μ²λ¦¬ λ°©λ²•μΌλ΅ λΉ„μ§€λ„ ν•™μµμ„ μ΄μ©ν•κΈ°λ„ ν•¨.
- λ€ν‘μ μΈ μΆ…λ¥λ΅ ν΄λ¬μ¤ν„°λ§(Clustering)μ΄ μμ.
- ex) λΉ„μ·ν• μ„±ν–¥μ κ³ κ° κ·Έλ£ΉμΌλ΅ λ¬¶κΈ°, λΈ”λ΅κ·Έμ—μ„  μ£Όμ λ³„λ΅ κµ¬λ¶„ν•κΈ°, μ μ‚¬ν• κ½ƒμ΄λ‚ λ™λ¬Όλ“¤λΌλ¦¬ λ¬¶κΈ°, λ„¤νΈμ›ν¬μƒμ λΉ„μ •μƒμ μΈ μ ‘κ·Όμ νƒμ§€

### **ν΄λ¬μ¤ν„°μ™€ ν΄λ¬μ¤ν„°λ§**

- ν΄λ¬μ¤ν„°λ” μ μ‚¬ν• μ—¬λ¬ κ°μ ν΄λμ¤λ΅ λ‚λ„μ–΄μ§„ λ°μ΄ν„°
- ν΄λ¬μ¤ν„°λ§μ€ μ μ‚¬ν• νΉμ„±μ„ κ°€μ§„ κ·Έλ£Ήλ“¤λ΅ λ¬¶λ” μ‘μ—…
- κ°™μ€ ν΄λ¬μ¤ν„°μ κ²ƒμ€ λ‹¤λ¥Έ ν΄λ¬μ¤ν„°μ κ²ƒλ³΄λ‹¤ λ” μ μ‚¬
- λ¶„λ¥μ™€ ν΄λ¬μ¤ν„°λ§μ μ°¨μ΄μ 
    - λ¶„λ¥λ” μ§€λ„ ν•™μµ, ν΄λ¬μ¤ν„°λ§μ€ λΉ„μ§€λ„ ν•™μµ μμ—­
    - λ¶„λ¥λ” λ°μ΄ν„°λ¥Ό κΈ°μ¤€μ— λ”°λΌ μ§μ„ μΌλ΅ λ¶„λ¥ν•λ” κ²ƒ
    - ν΄λ¬μ¤ν„°λ§μ€ μ μ‚¬μ„±μ— λ”°λΌ λ‡ κ°μ ν΄λ¬μ¤ν„°λ΅ λ¬¶λ” κ²ƒ

### **μ£Όμ” λΉ„μ§€λ„ ν•™μµ λ°©λ²•**

- **k-means ν΄λ¬μ¤ν„°λ§**
    - λΉ„μ§€λ„ ν•™μµ μ•κ³ λ¦¬μ¦ μ¤‘ λ€ν‘μ μΈ ν΄λ¬μ¤ν„°λ§ λ°©λ²•
    - μ°λ¦¬λ§λ΅ β€K-ν‰κ·  κµ°μ§‘ν™”β€™λΌκ³  ν•¨
    - μ μ‚¬ν• νΉμ„±μ„ κ°€μ§„ kκ°μ λ°μ΄ν„° κ·Έλ£ΉμΌλ΅ λ¬¶λ” λ°©λ²•
    - μ•κ³ λ¦¬μ¦μ΄ λΉ„κµμ  κ°„λ‹¨ν•κ³ , μν–‰ μ†λ„κ°€ λΉ λ¥΄λ‹¤.
    - ν΄λ¬μ¤ν„°λ§μ κ°μ kμ™€ μµμ΄λ΅ μ§€μ •ν•λ” μ¤‘μ‹¬μ λ“¤μ— λ”°λΌ κ²°κ³Ό
    κ°€ λ‹¤μ† λ‹¬λΌμ§ μ μλ‹¤.
    - ex) μ„±ν–¥ λ¶„μ„, κ³ κ° λ¶„λ¥, μ‹ μ©μΉ΄λ“ μ‚¬κΈ° νƒμ§€, λ§¤μ¶ κΈ°λ° νμ‚¬ λ“±κΈ‰ λ¶„λ¥, ν­ν’ μμΈ΅
- **μ¶”μ² μ‹μ¤ν…(Recommender System)**
    - μ‚¬μ©μμ β€μ„ νΈλ„β€™λ¥Ό μμΈ΅ν•λ” μ •λ³΄ ν•„ν„°λ§μ μΌμΆ…
    - μƒμ—…μ μΌλ΅ ν™μ© μ¤‘

## μ§€λ„ ν•™μµκ³Ό λΉ„μ§€λ„ ν•™μµμ νΉμ§• λΉ„κµ

| κΈ°λ° | μ§€λ„ ν•™μµ | λΉ„μ§€λ„ ν•™μµ |
| --- | --- | --- |
| μ…λ ¥ λ°μ΄ν„° | μ…μ¶λ ¥(κ°’ λλ” λ μ΄λΈ”)μ΄ μ§€μ •λ λ°μ΄ν„°λ¥Ό μ‚¬μ©ν•μ—¬ ν•™μµν•¨. | μ¶λ ¥κ°’μ΄λ‚ λ μ΄λΈ”μ΄ μ „ν€ μ—†λ” λ°μ΄ν„°λ¥Ό μ‚¬μ©ν•μ—¬ ν•™μµν•¨. |
| μ£Όμ” κΈ°λ¥ | λ¶„λ¥, νκ·€ | ν΄λ¬μ¤ν„°λ§, μ¶”μ² μ‹μ¤ν… |
| κ³„μ‚°μ λ³µμ΅μ„± | λΉ„κµμ  κ°„λ‹¨ν•¨ | μƒλ‹Ήν λ³µμ΅ν•¨ |
| μ •ν™•μ„± | λ§¤μ° μ •ν™•ν•¨ | λ‹¤μ† λ μ •ν™•ν•¨ |

## κ°•ν™” ν•™μµ

- μ£Όμ–΄μ§„ μ…λ ¥μ— λ€μ‘ν•λ” ν–‰λ™μ— λ€ν•΄ λ³΄μƒ(reward)μ„ ν†µν•΄ ν•™μµ
- μ£Όμ–΄μ§„ μ…λ ¥μ— λ€ν• μ¶λ ¥, μ¦‰ μ •λ‹µ ν–‰λ™μ΄ μ£Όμ–΄μ§€μ§€ μ•μ.
- μ£Όμ” μ‘μ© λ¶„μ•Όλ΅ λ΅λ΄‡, κ²μ„, λ‚΄λΉ„κ²μ΄μ… λ“±μ΄ μλ‹¤.

# λ¨Έμ‹ λ¬λ‹μ„ μ„ν• μ©μ–΄ μ •λ¦¬

[https://wikidocs.net/book/5942](https://wikidocs.net/book/5942)

## Feature (μ†μ„±, attribute)

- λ¨Έμ‹ λ¬λ‹μ΄λ‚ λ°μ΄ν„° λ¶„μ„μ— μ‚¬μ©λλ” κ°λ³„ λ…λ¦½ λ³€μ
- ν•™μµ λ° μμΈ΅μ„ ν•  λ°μ΄ν„°μ νΉμ§•, ν•­λ©
- Featureμ™€ Attributeλ” κ°™μ€ μ©μ–΄λ΅ μ΄μ©λλ‹¤.
- ex) μ§λ³‘ μ λ¬΄ νλ‹¨
ν‚¤, λΈλ¬΄κ², μ„±λ³„, λ‚μ΄, νμ••, μ‹μµκ΄€ λ“±μ΄ featureκ°€ λ  μ μλ‹¤.

## Label (class, target, κ²°μ •κ°’)

- μμΈ΅ν•κ³ μ ν•λ” λ€μƒ ν•­λ©

![Untitled](Machine%20Learning%201bf9420c06824cc1bdabb2497ca8765d/Untitled%204.png)

# μ‚¬μ΄ν‚·λ°

## μ‚¬μ΄ν‚·λ°μ΄λ€?

- λ¨Έμ‹ λ¬λ‹μ„ μ„ν• λ§¤μ° λ‹¤μ–‘ν• μ•κ³ λ¦¬μ¦κ³Ό κ°λ°μ„ μ„ν• νΈλ¦¬ν• ν”„λ μ„μ›ν¬μ™€ APIλ¥Ό μ κ³µ
- νμ΄μ¬ κΈ°λ°μ λ‹¤λ¥Έ λ¨Έμ‹ λ¬λ‹ ν¨ν‚¤μ§€λ„ μ‚¬μ΄ν‚·λ° μ¤νƒ€μΌμ APIλ¥Ό μ§€ν–¥ν•  μ •λ„λ΅Β μ‰½κ³  κ°€μ¥ νμ΄μ¬μ¤λ¬μ΄ APIλ¥Ό μ κ³µ
- [https://scikit-learn.org/stable/](https://scikit-learn.org/stable/)
- μ‚¬μ΄ν‚·λ°μΌλ΅ λ¨λΈμ„ κµ¬μ¶•μ‹, ν•΄κ²°ν•  λ¬Έμ μ— λ”°λ¥Έ μ μ ν• μ•κ³ λ¦¬μ¦
    
    ![Untitled](Machine%20Learning%201bf9420c06824cc1bdabb2497ca8765d/Untitled%205.png)
    

## μ‚¬μ΄ν‚·λ° κΈ°λ° ν”„λ μ„μ›ν¬

- Estimateμ™€ fit( ), predict( )
    
    ![Untitled](Machine%20Learning%201bf9420c06824cc1bdabb2497ca8765d/Untitled%206.png)
    
    - λ¶„λ¥ κµ¬ν„ ν΄λμ¤
        - DecisionTreeClassifier
        - RandomForestClassifier
        - GradientBoostingClassifier
        - GaussianNB
        - SVC
    - νκ·€ κµ¬ν„ ν΄λμ¤
        - LinearRegression
        - Ridge
        - Lasso
        - RandomForestRegressor
        - GrandientBoostingRegressor

## ****μ‚¬μ΄ν‚·λ°μ μ£Όμ” λ¨λ“****

![Untitled](Machine%20Learning%201bf9420c06824cc1bdabb2497ca8765d/Untitled%207.png)

## μ‚¬μ΄ν‚·λ° λ‚΄μ¥ μμ  λ°μ΄ν„°μ…‹

- λ¶„λ¥ λ° νκ·€μ©
    
    
    | APIλ… | μ„¤λ… |
    | --- | --- |
    | datasets.load_boston() | νκ·€ μ©λ„, λ―Έκµ­ λ³΄μ¤ν„΄μ μ§‘ ν”Όμ²λ“¤κ³Ό κ°€κ²©μ—
    λ€ν• λ°μ΄ν„° μ„ΈνΈ |
    | datasets.load_breast_cancer() | λ¶„λ¥ μ©λ„. μ„μ¤μ½μ‹  μ λ°©μ•” ν”Όμ²λ“¤κ³Ό μ•…μ„±/μμ„±
    λ μ΄λΈ” λ°μ΄ν„° μ„ΈνΈ |
    | datasets.load_diabetes() | νκ·€ μ©λ„. λ‹Ήλ‡¨ λ°μ΄ν„° μ„ΈνΈ |
    | datasets.load_digits() | λ¶„λ¥ μ©λ„. 0~9κΉμ§€ μ«μμ μ΄λ―Έμ§€ ν”½μ…€ λ°μ΄ν„°
    μ„ΈνΈ |
    | datasets.load_iris() | λ¶„λ¥ μ©λ„. λ¶“κ½ƒ λ°μ΄ν„° ν”Όμ²λ¥Ό κ°€μ§„ λ°μ΄ν„° μ„Έ
    νΈ |
- λ‚΄μ¥ μμ  λ°μ΄ν„°μ…‹ κµ¬μ„±
    
    ![Untitled](Machine%20Learning%201bf9420c06824cc1bdabb2497ca8765d/Untitled%208.png)
    

# iris λ°μ΄ν„° λ¶„λ¥ μμΈ΅ ν”„λ΅μ„Έμ¤ μ‹¤μµ

## μμΈ΅ μ „

- λ©μ  : λ¶“κ½ƒ λ°μ΄ν„° μ„ΈνΈλ” κ½ƒμμ κΈΈμ΄μ™€ λ„λΉ„, κ½ƒλ°›μΉ¨μ κΈΈμ΄μ™€ λ„λΉ„ ν”Όμ²
(Feature)μ„ κΈ°λ°μΌλ΅ κ½ƒμ ν’μΆ…μ„ μμΈ΅
- Feature : Sepal length, Sepal width, Petal length, Petal width
- Label :  iris setosa, iris versicolor, iris virginica
- ν•™μµλ°μ΄ν„°
    
    ![Untitled](Machine%20Learning%201bf9420c06824cc1bdabb2497ca8765d/Untitled%209.png)
    
- ν…μ¤νΈ λ°μ΄ν„°
    
    ![Untitled](Machine%20Learning%201bf9420c06824cc1bdabb2497ca8765d/Untitled%2010.png)
    
- λ¶„λ¥ μμΈ΅ ν”„λ΅μ„Έμ¤
    
    ![Untitled](Machine%20Learning%201bf9420c06824cc1bdabb2497ca8765d/Untitled%2011.png)
    
    - λ°μ΄ν„° μ„ΈνΈ λ¶„λ¦¬ : λ°μ΄ν„°λ¥Ό training dataμ™€ test dataλ΅ λ¶„λ¦¬
    - λ¨λΈ ν•™μµ : training dataλ¥Ό κΈ°λ°μΌλ΅ ML μ•κ³ λ¦¬μ¦μ„ μ μ©ν•μ—¬ λ¨λΈμ„ ν•™μµ
    - μμΈ΅ μν–‰ : ν•™μµλ ML λ¨λΈμ„ μ΄μ©ν•΄ test dataμ λ¶„λ¥λ¥Ό μμΈ΅
    - ν‰κ°€ : μ΄λ ‡κ² μμΈ΅λ κ²°κ³Όκ°’κ³Ό test dataμ μ‹¤μ  κ²°κ΄κ°’μ„ λΉ„κµν•΄ ML μ„±λ¨λΈ μ„±λ¥μ„ ν‰κ°€

## μμΈ΅

### **λ°μ΄ν„° μ„ΈνΈλ¥Ό λ΅λ”©**

- **μ‚¬μ΄ν‚·λ°μ— ν•„μ”ν• λ¨λ“ λ΅λ”©**
    
    ```python
    from sklearn.datasets import load_iris
    from sklearn.tree import DecisionTreeClassifier
    from sklearn.model_selection import train_test_split
    ```
    
- **λ°μ΄ν„°μ…‹ λ΅λ”© & λ°μ΄ν„° μ •λ³΄ ν™•μΈ**
    
    ```python
    # λ¶“κ½ƒ λ°μ΄ν„° μ„ΈνΈλ¥Ό λ΅λ”©
    iris = load_iris()
    
    # dir()λ” κ°μ²΄κ°€ μ–΄λ–¤ λ³€μμ™€ λ©”μ„λ“λ¥Ό κ°€μ§€κ³  μλ”μ§€ λ‚μ—΄ν•¨
    print(type(dir(iris))) 
    
    # λ©”μ„λ“ ν™•μΈ
    print(iris.keys())
    
    # shapeλ” λ°°μ—΄μ ν•μƒ μ •λ³΄λ¥Ό μ¶λ ¥
    print(iris_data.shape)
    
    # κ° labelμ μ΄λ¦„
    print(iris.target_names)
    
    # κ° featureμ μ΄λ¦„
    print(iris.feature_names)
    ```
    
    <aside>
    <img src="https://www.notion.so/icons/playback-play_red.svg" alt="https://www.notion.so/icons/playback-play_red.svg" width="40px" /> <class 'list'>
    dict_keys(['data', 'target', 'frame', 'target_names', 'DESCR', 'feature_names', 'filename', 'data_module'])
    (150, 4)
    ['setosa' 'versicolor' 'virginica']
    ['sepal length (cm)', 'sepal width (cm)', 'petal length (cm)', 'petal width (cm)']
    
    </aside>
    

### **DataFrame μλ£ν•μΌλ΅ λ³€ν™**

```python
import pandas as pd

# iris.dataλ” iris λ°μ΄ν„° μ„ΈνΈμ—μ„ ν”Όμ²(feature)λ§μΌλ΅ λ λ°μ΄ν„°λ¥Ό numpyλ΅ κ°€μ§€κ³  μλ‹¤.
iris_data = iris.data

# iris.targetμ€ iris λ°μ΄ν„° μ„ΈνΈμ—μ„ λ μ΄λΈ”(κ²°μ • κ°’) λ°μ΄ν„°λ¥Ό numpyλ΅ κ°€μ§€κ³  μλ‹¤.
# iris λ°μ΄ν„° μ„ΈνΈμ—μ„ ν”Όμ²λ“¤μ— ν•΄λ‹Ήν•λ” μ—΄μ μ΄λ¦„
iris_label = iris.target
print('iris targetκ°’ :', iris_label)
print('iris targetλ… :', iris.target_names)

# iris λ°μ΄ν„° μ„ΈνΈλ¥Ό μμ„Έν λ³΄κΈ° μ„ν•΄ DataFrameμΌλ΅ λ³€ν™
iris_df = pd.DataFrame(data=iris_data, columns=iris.feature_names)
iris_df['label'] = iris.target
iris_df.head(3)
```

<aside>
<img src="https://www.notion.so/icons/playback-play_red.svg" alt="https://www.notion.so/icons/playback-play_red.svg" width="40px" /> iris feature λ°μ΄ν„° κ°’ :
 [[5.1 3.5 1.4 0.2]
 [4.9 3.  1.4 0.2]
 [4.7 3.2 1.3 0.2]
 [4.6 3.1 1.5 0.2]
β€¦
[6.7 3.  5.2 2.3]
 [6.3 2.5 5.  1.9]
 [6.5 3.  5.2 2. ]
 [6.2 3.4 5.4 2.3]
 [5.9 3.  5.1 1.8]]

iris target λ°μ΄ν„° κ°’ : [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0  0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2]

iris targetλ… : ['setosa' 'versicolor' 'virginica']

![Untitled](Machine%20Learning%201bf9420c06824cc1bdabb2497ca8765d/Untitled%2012.png)

</aside>

### **train, test λ°μ΄ν„°μ…‹ λ¶„λ¦¬**

ν•™μµμ© λ°μ΄ν„°μ™€ ν…μ¤νΈμ© λ°μ΄ν„°λ” λ°λ“μ‹ λ¶„λ¦¬ν•΄μ•Ό ν•λ‹¤. ν•™μµ λ°μ΄ν„°λ΅ ν•™μµλ λ¨λΈμ΄ μ–Όλ§λ‚ λ›°μ–΄λ‚ μ„±λ¥μ„ κ°€μ§€λ”μ§€ ν‰κ°€ν•λ ¤λ©΄ ν…μ¤νΈ λ°μ΄ν„° μ„ΈνΈκ°€ ν•„μ”ν•κΈ° λ•λ¬Έ.

```python
X_train, X_test, y_train, y_test = train_test_split(iris_data, iris_label, test_size=0.2, random_state=11)

print('X_train κ°μ: ', len(X_train),', X_test κ°μ: ', len(X_test))
```

<aside>
<img src="https://www.notion.so/icons/playback-play_red.svg" alt="https://www.notion.so/icons/playback-play_red.svg" width="40px" /> X_train κ°μ:  120 , X_test κ°μ:  30

</aside>

- λ¬Έμ μ§€ : λ¨Έμ‹ λ¬λ‹ λ¨λΈμ—κ² μ…λ ¥λλ” λ°μ΄ν„°.Β **feature**λΌκ³  λ¶€λ¥΄κΈ°λ„ ν•λ‹¤. λ³€μ μ΄λ¦„μΌλ΅λ”Β `X`λ¥Ό λ§μ΄ μ‚¬μ©ν•λ‹¤.
- μ •λ‹µμ§€ : λ¨Έμ‹ λ¬λ‹ λ¨λΈμ΄ λ§ν€μ•Ό ν•λ” λ°μ΄ν„°.Β **label**Β λλ”Β **target**μ΄λΌκ³  λ¶€λ¥΄κΈ°λ„ ν•λ‹¤. λ³€μ μ΄λ¦„μΌλ΅λ”Β `y`λ¥Ό λ§μ΄ μ‚¬μ©ν•λ‹¤.
- μ²« λ²μ§Έ νλΌλ―Έν„° iris_data : ν”Όμ²(Feature) λ°μ΄ν„° μ„ΈνΈ
- λ‘ λ²μ§Έ νλΌλ―Έν„° iris_label : λ μ΄λΈ”(Label) λ°μ΄ν„° μ„ΈνΈ
- test_size : μ „μ²΄ λ°μ΄ν„° μ„ΈνΈ μ¤‘ ν…μ¤νΈ λ°μ΄ν„° μ„ΈνΈμ λΉ„μ¨
- random_state :  νΈμ¶ν•  λ•λ§λ‹¤ κ°™μ€ ν•™μµ/ν…μ¤νΈμ© λ°μ΄ν„° μ„ΈνΈλ¥Ό μƒμ„±ν•κΈ° μ„ν•΄ μ£Όμ–΄μ§€λ” λ‚μ λ°μƒ κ°’

### ****ν…μ¤νΈ λ°μ΄ν„° μ„ΈνΈλ΅ ν•™μµ(Train) μν–‰****

- μμΈ΅μ€ λ°λ“μ‹ ν•™μµ λ°μ΄ν„°κ°€ μ•„λ‹ λ‹¤λ¥Έ λ°μ΄ν„°λ¥Ό μ΄μ©ν•΄μ•Ό ν•λ©°, μΌλ°μ μΌλ΅ ν…μ¤νΈ λ°μ΄ν„° μ„ΈνΈλ¥Ό μ΄μ©
- DecisionTreeClassifier κ°μ²΄μ predict( ) λ©”μ„λ“μ— ν…μ¤νΈμ© ν”Όμ² λ°μ΄ν„° μ„ΈνΈλ¥Ό μ…λ ¥ν•΄ νΈμ¶ν•λ©΄ ν•™μµλ λ¨λΈ κΈ°λ°μ—μ„ ν…μ¤νΈ λ°μ΄ν„° μ„ΈνΈμ— λ€ν• μμΈ΅κ°’μ„ λ°ν™ν•κ² λλ‹¤.

```python
# Decision Tree μ‚¬μ©ν•κΈ°
# DecisionTreeClassifier κ°μ²΄ μƒμ„±
dt_clf = DecisionTreeClassifier(random_state=11)

# dt_clf μ type ν™•μΈ
print(dt_clf._estimator_type)

# ν•™μµμν–‰
dt_clf.fit(X_train, y_train)
```

<aside>
<img src="https://www.notion.so/icons/playback-play_red.svg" alt="https://www.notion.so/icons/playback-play_red.svg" width="40px" /> classifier

DecisionTreeClassifier(random_state=11)

</aside>

### **ν…μ¤νΈ λ°μ΄ν„° μ„ΈνΈλ΅ μμΈ΅(Predict) μν–‰**

```python
# ν•™μµμ΄ μ™„λ£λ DecisionTreeClassifier κ°μ²΄μ—μ„ ν…μ¤νΈ λ°μ΄ν„° μ„ΈνΈλ΅ μμΈ΅ μν–‰
pred = dt_clf.predict(X_test)
print(pred)

from sklearn.metrics import classification_report
print(classification_report(y_test, pred))
```

<aside>
<img src="https://www.notion.so/icons/playback-play_red.svg" alt="https://www.notion.so/icons/playback-play_red.svg" width="40px" /> [2 2 1 1 2 0 1 0 0 1 1 1 1 2 2 0 2 1 2 2 1 0 0 1 0 0 2 1 0 1]
              precision    recall  f1-score   support

           0       1.00      1.00      1.00         9
           1       0.83      1.00      0.91        10
           2       1.00      0.82      0.90        11

    accuracy                           0.93        30
   macro avg       0.94      0.94      0.94        30
weighted avg       0.94      0.93      0.93        30

</aside>

### **μμΈ΅ μ •ν™•λ„ ν‰κ°€**

- μ •ν™•λ„λ” μμΈ΅ κ²°κ³Όκ°€ μ‹¤μ  λ μ΄λΈ” κ°’κ³Ό μ–Όλ§λ‚ μ •ν™•ν•κ² λ§λ”μ§€λ¥Ό ν‰κ°€ν•λ” μ§€ν‘
- μ‚¬μ΄ν‚·λ°μ€ μ •ν™•λ„ μΈ΅μ •μ„ μ„ν•΄ accuracy_score( ) ν•¨μλ¥Ό μ κ³µ
- μ²« λ²μ§Έ νλΌλ―Έν„° : μ‹¤μ  λ μ΄λΈ” λ°μ΄ν„° μ„ΈνΈ
- λ‘ λ²μ§Έ νλΌλ―Έν„° : μμΈ΅ λ μ΄λΈ” λ°μ΄ν„° μ„ΈνΈ

```python
from sklearn.metrics import accuracy_score
print('μμΈ΅ μ •ν™•λ„: {0:.4f}'.format(accuracy_score(y_test,pred)))
```

<aside>
<img src="https://www.notion.so/icons/playback-play_red.svg" alt="https://www.notion.so/icons/playback-play_red.svg" width="40px" /> μμΈ΅ μ •ν™•λ„: 0.9333

</aside>

![Untitled](Machine%20Learning%201bf9420c06824cc1bdabb2497ca8765d/Untitled%2013.png)

# κµμ°¨ κ²€μ¦

## κµμ°¨ κ²€μ¦μ΄λ€?

- ν•™μµ λ°μ΄ν„°μ„ΈνΈλ¥Ό λ‹¤μ‹Β `ν•™μµ λ°μ΄ν„°μ„ΈνΈ`Β /Β `κ²€μ¦ λ°μ΄ν„°μ„ΈνΈ`λ΅ λ‚λ”
    - ν•™μµ λ°μ΄ν„° μ„ΈνΈ : ν•™μµμ„ μ„ν• λ°μ΄ν„°
    - κ²€μ¦ λ°μ΄ν„° μ„ΈνΈ : ν•™μµλ λ¨λΈμ μ„±λ¥μ„ μΌμ°¨ ν‰κ°€
    - ν‰κ°€ λ°μ΄ν„° μ„ΈνΈ : λ¨λ“  ν•™μµ/κ²€μ¦ κ³Όμ •μ΄ μ™„λ£λ ν›„ μµμΆ…μ μΌλ΅ μ„±λ¥μ„ ν‰κ°€
- κ²€μ¦ λ°μ΄ν„° μ„ΈνΈκ°€ ν•„μ”ν• μ΄μ ?
    - train λ°μ΄ν„°μ— λ€ν•΄μ„ λ°μƒν•λ” κ³Όμ ν•©(Overfitting)μ„ λ°©μ§€ν•κΈ° μ„ν•΄
    - train λ°μ΄ν„°μ—λ§ μ—΄μ‹¬ν ν•™μµ μ‹μΌ°λ”λ°, λ§‰μƒ test λ°μ΄ν„°μ—μ„λ” λ§μ§€ μ•μ„ μ μκΈ° λ•λ¬Έμ— μ°μ„  κ²€μ¦ λ°μ΄ν„°λ΅ ν‰κ°€
    - κµμ°¨κ²€μ¦μ€ κ²€μ¦μ„ μ—¬λ¬λ² ν•΄μ„ μ–΄λ λ°μ΄ν„°μ—μ„λ‚ μ λ§λ”μ§€ ν™•μΈ

## K ν΄λ“ κµμ°¨ κ²€μ¦

- κ°€μ¥ λ³΄νΈμ μΈ κµμ°¨ κ²€μ¦ κΈ°λ²•
- Kκ°μ λ°μ΄ν„° ν΄λ“ μ„ΈνΈλ¥Ό λ§λ“¤μ–΄μ„ Kλ² λ§νΌ κ° ν΄νΈ μ„ΈνΈμ— ν•™μµκ³Ό κ²€μ¦ ν‰κ°€λ¥Ό λ°λ³µμ μΌλ΅ μν–‰
- κ° κ²€μ¦λ§λ‹¤ Test Foldλ¥Ό λ‹¤λ¥΄κ² μ§€μ •ν•μ—¬ μ„±λ¥μ„ μΈ΅μ •
    
    ![Untitled](Machine%20Learning%201bf9420c06824cc1bdabb2497ca8765d/Untitled%2014.png)
    
    - K ν΄λ“ κµμ°¨ κ²€μ¦ κ³Όμ • μμ„Έν
        1. μ „μ²΄Β Datasetμ΄ Train Datasetκ³Ό Test DatasetμΌλ΅ μ£Όμ–΄μ§‘λ‹λ‹¤.
        2. TrainΒ Datasetμ„ λ‚λΒ *k*λ¥Ό μ§€μ •ν•κ³ , κ°€κΈ‰μ  κ· λ“±ν•κ² κ·Έλ¦¬κ³  λλ¤μΌλ΅Β *k*κ°μ λ°μ΄ν„° Foldλ΅ λ‚λ„λΒ (*k*Β - 1)κ°μ Foldλ” Testμ©μΌλ΅ 1κ°λ” Validationμ©μΌλ΅ μ§€μ •ν•©λ‹λ‹¤.
        3. νλ‹ν•κ³ μ ν•λ” Hyperparametersλ¥Ό μ •ν•©λ‹λ‹¤.
        4. μ •ν•΄μ§„Β Hyperparametersμ— λ€ν•μ—¬ κ°κ° κ²€μ¦ν•κ³ μ ν•λ” λ²”μ„μ™€ μ‹¤ν—μ„ΈνΈ(μ”μΈ μμ¤€)λ¥Ό μ •ν•©λ‹λ‹¤.
        5. *k*κ°λ΅ λ‚λ„μ–΄μ§„ Train DatasetΒ λ°μ΄ν„° κ·Έλ£Ήμ— λ€ν•μ—¬ μ„λ΅ λ‹¤λ¥Έ Validation Foldλ¥Ό μ§€μ •ν•λ©΄μ„ μ•„λμ μ¤νΌλ μ΄μ…μ„Β *k*λ² λ°λ³µν•©λ‹λ‹¤.
        Β· (*k*Β - 1)κ°μ Train Foldμ— λ€ν•μ—¬ ν•™μµμ„ μ‹ν‚µλ‹λ‹¤.
        Β· λ‚λ¨Έμ§€ 1κ°μ Validation Foldμ— λ€ν•μ—¬ μ„±λ¥μ„ μΈ΅μ •ν•©λ‹λ‹¤. μ¦‰, μ•μ„ ν•™μµλ νλΌλ―Έν„°λ¥Ό μ΄μ©ν•μ—¬ Validation Foldλ¥Ό μ΄μ©ν•μ—¬ κ²°κ³Όλ¥Ό μ–»μµλ‹λ‹¤.
        6. 5λ²μ—μ„ μ–»μ€ κ° HyperparamerμΒ *k*κ°μ κ²°κ³Όμ— λ€ν• ν‰κ· μ„ κ³„μ‚°ν•μ—¬ μ΄ ν‰κ· κ°’μ„ κ° Hyperaparameterλ΅ μ§€μ •ν•©λ‹λ‹¤.
        7. λ§μ§€λ§‰μΌλ΅, 6λ²μ—μ„ μ–»μ€Β Hyperparametersλ¥Ό μ μ©ν•μ—¬ Test Dataμ— λ€ν•μ—¬ λ¨λΈμ„ 1ν ν‰κ°€ν•©λ‹λ‹¤.

## **Stratified K ν΄λ“**

- λ°μ΄ν„° λ μ΄λΈ”μ λ¶„ν¬κ°€ λ¶κ· ν•ν•  κ²½μ°, μ›λ³Έ λ°μ΄ν„°μ™€ μ μ‚¬ν• λ μ΄λΈ” κ°’μ λ¶„ν¬λ¥Ό ν•™μµ/ν…μ¤νΈ μ„ΈνΈμ—λ„ μ μ§€ν•  ν•„μ”κ°€ μλ‹¤.
- μ΄λ ‡κ² λ¶„ν¬λ¥Ό μ μ§€ν•κ² λ§λ“λ” κ²ƒμ„ stratifyλ΅ μν–‰ν•  μ μμΌλ©°, νΉν λ°μ΄ν„°μ κ°μκ°€ μ μ„ μ‹μ— μ΄ κ³Όμ •μ΄ ν•„μ”ν•λ‹¤.
- K ν΄λ“κ°€ λ μ΄λΈ” λ°μ΄ν„° μ§‘ν•©μ΄ μ›λ³Έ λ°μ΄ν„° μ§‘ν•©μ λ μ΄λΈ” λ¶„ν¬λ¥Ό ν•™μµ λ° ν…μ¤νΈ μ„ΈνΈμ— μ λ€λ΅ λ¶„λ°°ν•μ§€ λ»ν•λ” κ²½μ°μ λ¬Έμ λ¥Ό ν•΄κ²°ν•΄ μ¤€λ‹¤.
- Stratified K ν΄λ“λ” μ›λ³Έ λ°μ΄ν„°μ λ μ΄λΈ” λ¶„ν¬λ¥Ό λ¨Όμ € κ³ λ ¤ν• λ’¤ μ΄ λ¶„ν¬μ™€ λ™μΌν•κ² ν•™μµκ³Ό κ²€μ¦ λ°μ΄ν„° μ„ΈνΈλ¥Ό λ¶„λ°°ν•λ‹¤.

## GridSearchCV

- λ¨Έμ‹ λ¬λ‹μ—μ„ λ¨λΈμ μ„±λ¥ν–¥μƒμ„ μ„ν•΄ μ“°μ΄λ” κΈ°λ²•
- μ‚¬μ©μκ°€ μ§μ ‘ λ¨λΈμ ν•μ΄νΌ νλΌλ―Έν„°μ κ°’μ„ λ¦¬μ¤νΈλ΅ μ…λ ¥ν•λ©΄ κ°’μ— λ€ν• κ²½μ°μ μλ§λ‹¤ μμΈ΅ μ„±λ¥μ„ μΈ΅μ • ν‰κ°€ν•μ—¬ λΉ„κµν•λ©΄μ„ μµμ μ ν•μ΄νΌ νλΌλ―Έν„° κ°’μ„ μ°Ύλ” κ³Όμ •
- μμ‹
    
    ```python
    parameters = {'max_depth':[1, 2, 3], 'min_samples_split':[2,3]}
    ```
    
    ![Untitled](Machine%20Learning%201bf9420c06824cc1bdabb2497ca8765d/Untitled%2015.png)
    
    β‡’ νλΌλ―Έν„°μ μ§‘ν•©μ„ λ§λ“¤κ³  μ΄λ¥Ό μμ°¨μ μΌλ΅ μ μ©ν•λ©΄μ„ μµμ ν™”λ¥Ό μν–‰
    
- μ£Όμ” νλΌλ―Έν„°
    - ν•μ΄νΌνλΌλ―Έν„°λ€ : μ‚¬μ©μμ μ…λ ¥κ°’, μ¦‰ μ°λ¦¬κ°€ μ„¤μ • κ°€λ¥ν• μ…λ ¥κ°’
    - estimator : μμΈ΅κΈ° κ°μ²΄ (Classifier, Regressor, Pipeline λ“±)
    - param_grid : μ‚¬μ©ν•  νλΌλ―Έν„°κ°€ μ •μλ dictionary
    - scoringΒ : μμΈ΅ μ„±λ¥μ„ μΈ΅μ •ν•  ν‰κ°€ λ°©λ²•μ„ μ§€μ •
    - cv : κµμ°¨κ²€μ¦ κ°μ (KFold κ°μ²΄λ¥Ό λ„£μ„ μλ„ μλ‹¤.)
    - refitΒ : λ””ν΄νΈκ°€ Trueμ΄λ©° Trueλ΅ μƒμ„± μ‹ κ°€μ¥ μµμ μ ν•μ΄νΌ νλΌλ―Έν„°λ¥Ό μ°Ύμ€ λ’¤ μ…λ ¥λ esitmator κ°μ²΄λ¥Ό ν•΄λ‹Ή ν•μ΄νΌ νλΌλ―Έν„°λ΅ μ¬ν•™μµ

## ****cross_val_score( )****

- κµμ°¨ κ²€μ¦μ„ μΆ€ λ” νΈλ¦¬ν•κ² μν–‰ν•  μ μκ² ν•΄μ£Όλ” API
- KFoldλ΅ λ°μ΄ν„°λ¥Ό ν•™μµν•κ³  μμΈ΅
- K ν΄λ“μ μμΈ΅ ν”„λ΅μ„Έμ¤λ¥Ό ν•λ²μ— μν–‰
- μ„ μ–Έ ν•νƒ
    
    ```python
    cross_val_score(estimator, X, y=None, scoring=None, cv=None, 
    			n_jobs=1, verbose=0, fit_params=None, pre_dispatch='2*n_jobs')
    ```
    
    - **esmitator**Β :Β  μ‚¬μ΄ν‚·λ°μ λ¶„λ¥ μ•κ³ λ¦¬μ¦ ν΄λμ¤μΈ Classifier λλ” νκ·€ μ•κ³ λ¦¬μ¦ ν΄λμ¤μΈ Regressorλ¥Ό μλ―Έ
    - **X**Β : ν”Όμ² λ°μ΄ν„° μ„ΈνΈ
    - **y**Β : λ μ΄λΈ” λ°μ΄ν„° μ„ΈνΈ
    - **scoring**Β : μμΈ΅ μ„±λ¥ ν‰κ°€ μ§€ν‘λ¥Ό κΈ°μ 
    - **cv**Β : κµμ°¨ κ²€μ¦ ν΄λ“ μ
- cross_val_score( ) μν–‰ ν›„ λ°ν™ κ°’μ€ scoring νλΌλ―Έν„°λ΅ μ§€μ •λ μ„±λ¥ μ§€ν‘ μΈ΅μ •κ°’μ„ λ°°μ—΄ ν•νƒλ΅ λ°ν™
- classifierκ°€ μ…λ ¥λλ©΄ Stratified K ν΄λ“ λ°©μ‹μΌλ΅ λ μ΄λΈ”κ°’μ λ¶„ν¬μ— λ”°λΌ ν•™μµ/ν…μ¤νΈ μ„ΈνΈλ¥Ό λ¶„ν• 
- νκ·€μΈ κ²½μ°μ—λ” Stratified K ν΄λ“ λ°©μ‹μΌλ΅ λ¶„ν• ν•  μ μ—†μΌλ―€λ΅ K ν΄λ“ λ°©μ‹μΌλ΅ λ¶„ν• 

# iris λ°μ΄ν„° κµμ°¨ κ²€μ¦ μ‹¤μµ

## K ν΄λ“

- K ν΄λ“ κµμ°¨ κ²€μ¦ ν”„λ΅μ„Έμ¤λ¥Ό κµ¬ν„ν•κΈ° μ„ν•΄ KFoldμ™€ StratifiedKFold ν΄λμ¤λ¥Ό μ κ³µ
- KFold ν΄λμ¤λ¥Ό μ΄μ©ν•΄ λ¶“κ½ƒ λ°μ΄ν„° μ„ΈνΈλ¥Ό κµμ°¨ κ²€μ¦ν•κ³  μμΈ΅ μ •ν™•λ„λ¥Ό μ•μ•„λ³Έλ‹¤.

### λ°μ΄ν„° λ΅λ“

```python
from sklearn.tree import DecisionTreeClassifier
from sklearn.metrics import accuracy_score
from sklearn.model_selection import KFold
import numpy as np

iris = load_iris()
features = iris.data
label = iris.target
dt_clf = DecisionTreeClassifier(random_state=156)
```

### kκ°μ ν΄λ“ μ„ΈνΈλ΅ λ¶„λ¦¬ν•λ” KFold κ°μ²΄ μƒμ„±

```python
kfold = KFold(n_splits=5)
cv_accuracy = []
print('λ¶“κ½ƒ λ°μ΄ν„°μ„ΈνΈ ν¬κΈ° :', features.shape[0])
```

<aside>
<img src="https://www.notion.so/icons/playback-play_red.svg" alt="https://www.notion.so/icons/playback-play_red.svg" width="40px" /> λ¶“κ½ƒ λ°μ΄ν„°μ„ΈνΈ ν¬κΈ° : 150

</aside>

ν„μ¬ λ¶“κ½ƒ λ°μ΄ν„° μ„ΈνΈμ ν¬κΈ°κ°€ 150μ΄λ‹¤.

k=5λ‹κΉ 5λ¶„ν• ν•΄μ„ ν•™μµ λ°μ΄ν„°μ„ΈνΈ ν¬κΈ°λ” 120, κ²€μ¦ λ°μ΄ν„°μ„ΈνΈ ν¬κΈ°λ” 30

### μ „μ²΄ λ¶“κ½ƒ λ°μ΄ν„°λ¥Ό 5κ°μ ν΄λ“ λ°μ΄ν„° μ„ΈνΈλ΅ λ¶„λ¦¬

- μ΄μ  μƒμ„±λ KFold κ°μ²΄μ split( )μ„ νΈμ¶ν•΄ μ „μ²΄ λ¶“κ½ƒ λ°μ΄ν„°λ¥Ό 5κ°μ ν΄λ“ λ°μ΄ν„° μ„ΈνΈλ΅ λ¶„λ¦¬
- KFold κ°μ²΄λ” split( )μ„ νΈμ¶ν•λ©΄ ν•™μµμ©/κ²€μ¦μ© λ°μ΄ν„°λ΅ λ¶„ν• ν•  μ μλ” μΈλ±μ¤λ¥Ό λ°ν™ν•λ‹¤.

```python
n_iter = 0

# KFoldκ°μ²΄μ split() νΈμ¶ν•λ©΄ ν΄λ“ λ³„ ν•™μµμ©, κ²€μ¦μ© ν…μ¤νΈμ λ΅μ° μΈλ±μ¤λ¥Ό arrayλ΅ λ°ν™

for train_index, test_index in kfold.split(features): # features = iris.data
    # kfold.split()μΌλ΅ λ°ν™λ μΈλ±μ¤λ¥Ό μ΄μ©ν•μ—¬ ν•™μµμ©, κ²€μ¦μ© λ°μ΄ν„° μ¶”μ¶
    X_train, X_test = features[train_index], features[test_index]
    y_train, y_test = label[train_index], label[test_index]
    # ν•™μµ λ° μμΈ΅
    dt_clf.fit(X_train, y_train)
    pred = dt_clf.predict(X_test)
    n_iter += 1
    # λ°λ³µ μ‹ λ§λ‹¤ μ •ν™•λ„ μΈ΅μ •
    accuracy = np.round(accuracy_score(y_test,pred),4)
    train_size=X_train.shape[0]
    test_size=X_test.shape[0]
    print('\n#{0} κµμ°¨ κ²€μ¦ μ •ν™•λ„:{1}, ν•™μµλ°μ΄ν„° ν¬κΈ°:{2},  κ²€μ¦λ°μ΄ν„° ν¬κΈ°:{3}'
         .format(n_iter, accuracy, train_size, test_size))
    print('#{0} κ²€μ¦ μ„ΈνΈ μΈλ±μ¤{1}'.format(n_iter,test_index))
    cv_accuracy.append(accuracy)
    
# κ°λ³„ iterationλ³„ μ •ν™•λ„λ¥Ό ν•©ν•μ—¬ ν‰κ·  μ •ν™•λ„ κ³„μ‚°
print('\n## ν‰κ·  κ²€μ¦ μ •ν™•λ„', np.mean(cv_accuracy))
# ν‰κ· κ°’μ„ κ° Hyperaparameterλ΅ μ§€μ •
```

<aside>
<img src="https://www.notion.so/icons/playback-play_red.svg" alt="https://www.notion.so/icons/playback-play_red.svg" width="40px" /> #1 κµμ°¨ κ²€μ¦ μ •ν™•λ„:1.0, ν•™μµλ°μ΄ν„° ν¬κΈ°:120,  κ²€μ¦λ°μ΄ν„° ν¬κΈ°:30
#1 κ²€μ¦ μ„ΈνΈ μΈλ±μ¤[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 24 25 26 27 28 29]

#2 κµμ°¨ κ²€μ¦ μ •ν™•λ„:0.9667, ν•™μµλ°μ΄ν„° ν¬κΈ°:120,  κ²€μ¦λ°μ΄ν„° ν¬κΈ°:30
#2 κ²€μ¦ μ„ΈνΈ μΈλ±μ¤[30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53
 54 55 56 57 58 59]

#3 κµμ°¨ κ²€μ¦ μ •ν™•λ„:0.8667, ν•™μµλ°μ΄ν„° ν¬κΈ°:120,  κ²€μ¦λ°μ΄ν„° ν¬κΈ°:30
#3 κ²€μ¦ μ„ΈνΈ μΈλ±μ¤[60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83
 84 85 86 87 88 89]

#4 κµμ°¨ κ²€μ¦ μ •ν™•λ„:0.9333, ν•™μµλ°μ΄ν„° ν¬κΈ°:120,  κ²€μ¦λ°μ΄ν„° ν¬κΈ°:30
#4 κ²€μ¦ μ„ΈνΈ μΈλ±μ¤[ 90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107
 108 109 110 111 112 113 114 115 116 117 118 119]

#5 κµμ°¨ κ²€μ¦ μ •ν™•λ„:0.7333, ν•™μµλ°μ΄ν„° ν¬κΈ°:120,  κ²€μ¦λ°μ΄ν„° ν¬κΈ°:30
#5 κ²€μ¦ μ„ΈνΈ μΈλ±μ¤[120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137
 138 139 140 141 142 143 144 145 146 147 148 149]

## ν‰κ·  κ²€μ¦ μ •ν™•λ„ 0.9

</aside>

## ****Stratified K ν΄λ“****

### λ°μ΄ν„° λ΅λ“

```python
from sklearn.tree import DecisionTreeClassifier
from sklearn.metrics import accuracy_score
from sklearn.model_selection import KFold
import numpy as np
import pandas as pd

iris = load_iris()

iris_df = pd.DataFrame(data = iris.data, columns=iris.feature_names)
iris_df['label'] = iris.target
iris_df['label'].value_counts()
print(iris_df)
```

<aside>
<img src="https://www.notion.so/icons/playback-play_red.svg" alt="https://www.notion.so/icons/playback-play_red.svg" width="40px" /> 0    50
1    50
2    50
Name: label, dtype: int64

```
     sepal length (cm)  sepal width (cm)  petal length (cm)  petal width (cm)  label
0                  5.1               3.5                1.4               0.2      0
1                  4.9               3.0                1.4               0.2      0
2                  4.7               3.2                1.3               0.2      0
3                  4.6               3.1                1.5               0.2      0
4                  5.0               3.6                1.4               0.2      0
..                 ...               ...                ...               ...    ...
145                6.7               3.0                5.2               2.3      2
146                6.3               2.5                5.0               1.9      2
147                6.5               3.0                5.2               2.0      2
148                6.2               3.4                5.4               2.3      2
149                5.9               3.0                5.1               1.8      2

[150 rows x 5 columns]
```

</aside>

### ****Stratified K ν΄λ“ κ°μ²΄ μƒμ„± & 3κ°μ λ°μ΄ν„° ν΄λ“ μ„ΈνΈ μƒμ„±****

- μ΄μκ°€ λ°μƒν•λ” ν„μƒμ„ λ„μ¶ν•κΈ° μ„ν•΄ 3κ°μ ν΄λ“ μ„ΈνΈλ¥Ό KFoldλ΅ μƒμ„±ν•κ³ , κ° κµμ°¨ κ²€μ¦ μ‹λ§λ‹¤ μƒμ„±λλ” ν•™μµ/κ²€μ¦ λ μ΄λΈ” λ°μ΄ν„° κ°’μ λ¶„ν¬λ„λ¥Ό ν™•μΈν•΄λ³Έλ‹¤.

```python
kfold = KFold(n_splits=3)

# kfol.split(X)λ” ν΄λ“ μ„ΈνΈλ¥Ό 3λ² λ°λ³µν•  λ•λ§λ‹¤ λ‹¬λΌμ§€λ” ν•™μµ/ν…μ¤νΈμ© λ°μ΄ν„° λ΅μ° μΈλ±μ¤ λ²νΈ λ°ν™.

n_iter = 0
for train_index, test_index in kfold.split(iris_df):
    n_iter += 1
    label_train = iris_df['label'].iloc[train_index]
    label_test = iris_df['label'].iloc[test_index]
    print('## κµμ°¨ κ²€μ¦: {0}'.format(n_iter))
    print('ν•™μµ λ μ΄λΈ” λ°μ΄ν„° λ¶„ν¬:\n', label_train.value_counts())
    print('κ²€μ¦ λ μ΄λΈ” λ°μ΄ν„° λ¶„ν¬:\n', label_test.value_counts())
```

<aside>
<img src="https://www.notion.so/icons/playback-play_red.svg" alt="https://www.notion.so/icons/playback-play_red.svg" width="40px" /> ## κµμ°¨ κ²€μ¦: 1
ν•™μµ λ μ΄λΈ” λ°μ΄ν„° λ¶„ν¬:
 1    50
2    50
Name: label, dtype: int64
κ²€μ¦ λ μ΄λΈ” λ°μ΄ν„° λ¶„ν¬:
 0    50
Name: label, dtype: int64

## κµμ°¨ κ²€μ¦: 2
ν•™μµ λ μ΄λΈ” λ°μ΄ν„° λ¶„ν¬:
 0    50
2    50
Name: label, dtype: int64
κ²€μ¦ λ μ΄λΈ” λ°μ΄ν„° λ¶„ν¬:
 1    50
Name: label, dtype: int64

## κµμ°¨ κ²€μ¦: 3
ν•™μµ λ μ΄λΈ” λ°μ΄ν„° λ¶„ν¬:
 0    50
1    50
Name: label, dtype: int64
κ²€μ¦ λ μ΄λΈ” λ°μ΄ν„° λ¶„ν¬:
 2    50
Name: label, dtype: int64

</aside>

- κµμ°¨ κ²€μ¦ μ‹λ§λ‹¤ 3κ°μ ν΄λ“ μ„ΈνΈλ΅ λ§λ“¤μ–΄μ§€λ” ν•™μµ λ μ΄λΈ”κ³Ό κ²€μ¦ λ μ΄λΈ”μ΄ μ™„μ „ν λ‹¤λ¥Έ κ°’μΌλ΅ μ¶”μ¶λμ—λ‹¤.
- μλ¥Ό λ“¤μ–΄ μ²« λ²μ§Έ κµμ°¨ κ²€μ¦μ—μ„ ν•™μµ λ μ΄λΈ”μ€ 1, 2λ°–μ— μ—†μΌλ―€λ΅ 0μ κ²½μ°λ” μ „ν€ ν•™μµν•μ§€ λ»ν•λ‹¤. λ°λ€λ΅ κ²€μ¦ λ μ΄λΈ”μ€ 0λ°–μ— μ—†μΌλ―€λ΅ ν•™μµ λ¨λΈμ€ μ λ€ 0μ„ μμΈ΅ν•μ§€ λ»ν•λ‹¤.
- μ΄λ° μ ν•μΌλ΅ κµμ°¨ κ²€μ¦ λ°μ΄ν„° μ„ΈνΈλ¥Ό λ¶„ν• ν•λ©΄ κ²€μ¦ μμΈ΅ μ •ν™•λ„λ” 0μ΄ λ  μ λ°–μ— μ—†λ‹¤.

<aside>
π’΅ StratifiedKFoldλ” μ΄λ ‡κ² KFoldλ΅ λ¶„ν• λ λ μ΄λΈ” λ°μ΄ν„° μ„ΈνΈκ°€ μ „μ²΄ λ μ΄λΈ” κ°’μ λ¶„ν¬λ„λ¥Ό λ°μν•μ§€ λ»ν•λ” λ¬Έμ λ¥Ό ν•΄κ²°ν•΄μ¤€λ‹¤.

StratifiedKFoldλ¥Ό μ‚¬μ©ν•λ” λ°©λ²•μ€ KFoldλ¥Ό μ‚¬μ©ν•λ” λ°©λ²•κ³Ό κ±°μ λΉ„μ·ν•λ‹¤. 

λ‹¨ ν•λ‚ ν° μ°¨μ΄λ” StratifiedKFoldλ” λ μ΄λΈ” λ¶„ν¬λ„μ— λ”°λΌ ν•™μµ/κ²€μ¦ λ°μ΄ν„°λ¥Ό λ‚λ„κΈ° λ•λ¬Έμ— split( )λ©”μ„λ“μ— μΈμλ΅ ν”Όμ² λ°μ΄ν„° μ„ΈνΈλΏλ§ μ•„λ‹λΌ λ μ΄λΈ” λ°μ΄ν„° μ„ΈνΈλ„ λ°λ“μ‹ ν•„μ”ν•λ‹¤.

</aside>

### KFoldμ λ¬Έμ  ν•΄κ²°

```python
from sklearn.model_selection import StratifiedKFold

skf = StratifiedKFold(n_splits=3)
n_iter = 0

for train_index, test_index in skf.split(iris_df, iris_df['label']):
    n_iter += 1
    label_train = iris_df['label'].iloc[train_index]
    label_test = iris_df['label'].iloc[test_index]
    print('## κµμ°¨ κ²€μ¦: {0}'.format(n_iter))
    print('ν•™μµ λ μ΄λΈ” λ°μ΄ν„° λ¶„ν¬:\n', label_train.value_counts())
    print('κ²€μ¦ λ μ΄λΈ” λ°μ΄ν„° λ¶„νΈ:\n', label_test.value_counts())
```

<aside>
<img src="https://www.notion.so/icons/playback-play_red.svg" alt="https://www.notion.so/icons/playback-play_red.svg" width="40px" /> ## κµμ°¨ κ²€μ¦: 1
ν•™μµ λ μ΄λΈ” λ°μ΄ν„° λ¶„ν¬:
 2    34
0    33
1    33
Name: label, dtype: int64
κ²€μ¦ λ μ΄λΈ” λ°μ΄ν„° λ¶„νΈ:
 0    17
1    17
2    16
Name: label, dtype: int64

## κµμ°¨ κ²€μ¦: 2
ν•™μµ λ μ΄λΈ” λ°μ΄ν„° λ¶„ν¬:
 1    34
0    33
2    33
Name: label, dtype: int64
κ²€μ¦ λ μ΄λΈ” λ°μ΄ν„° λ¶„νΈ:
 0    17
2    17
1    16
Name: label, dtype: int64

## κµμ°¨ κ²€μ¦: 3
ν•™μµ λ μ΄λΈ” λ°μ΄ν„° λ¶„ν¬:
 0    34
1    33
2    33
Name: label, dtype: int64
κ²€μ¦ λ μ΄λΈ” λ°μ΄ν„° λ¶„νΈ:
 1    17
2    17
0    16
Name: label, dtype: int64

</aside>

- ν•™μµ λ μ΄λΈ”κ³Ό κ²€μ¦ λ μ΄λΈ” λ°μ΄ν„° κ°’μ λ¶„ν¬λ„κ°€ λ™μΌν•κ² ν• λ‹Ήλμ
- 

### **train, test λ°μ΄ν„°μ…‹ λ¶„λ¦¬ & μμΈ΅ μ •ν™•λ„ ν‰κ°€**

```python
df_clf = DecisionTreeClassifier(random_state=156)

skfold = StratifiedKFold(n_splits=3)
n_iter = 0
cv_accuracy = []

# StratifiedKFoldμ split() νΈμ¶μ‹ λ°λ“μ‹ λ μ΄λΈ” λ°μ΄ν„°μ…‹λ„ μ¶”κ°€ μ…λ ¥ ν•„μ”
for train_index, test_index in skfold.split(features, label):
    # split()μΌλ΅ λ°ν™λ μΈλ±μ¤λ¥Ό μ΄μ©ν•μ—¬ ν•™μµμ©, κ²€μ¦μ© ν…μ¤νΈ λ°μ΄ν„° μ¶”μ¶
    X_train, X_test = features[train_index], features[test_index]
    y_train, y_test = label[train_index], label[test_index]
    # ν•™μµ λ° μμΈ΅
    dt_clf.fit(X_train, y_train)
    pred = dt_clf.predict(X_test)
    
    #λ°λ³µμ‹ λ§λ‹¤ μ •ν™•λ„ μΈ΅μ •
    n_iter += 1
    accuracy = np.round(accuracy_score(y_test, pred), 4)
    train_size = X_train.shape[0]
    test_size = X_test.shape[0]
    print('\n{0} κµμ°¨ κ²€μ¦ μ •ν™•λ„ :{1}, ν•™μµ λ°μ΄ν„° ν¬κΈ°: {2}, κ²€μ¦ λ°μ΄ν„° ν¬κΈ°: {3}'
         .format(n_iter, accuracy, train_size, test_size))
    print('#{0} κ²€μ¦ μ„ΈνΈ μΈλ±μ¤:{1}'.format(n_iter, test_index))
    cv_accuracy.append(accuracy)
    
# κµμ°¨ κ²€μ¦λ³„ μ •ν™•λ„ λ° ν‰κ·  μ •ν™•λ„ κ³„μ‚°
print('\n## κµμ°¨ κ²€μ¦λ³„ μ •ν™•λ„:', np.round(cv_accuracy,4))
print('## ν‰κ·  κ²€μ¦ μ •ν™•λ„:', np.mean(cv_accuracy))
```

<aside>
<img src="https://www.notion.so/icons/playback-play_red.svg" alt="https://www.notion.so/icons/playback-play_red.svg" width="40px" /> 1 κµμ°¨ κ²€μ¦ μ •ν™•λ„ :0.98, ν•™μµ λ°μ΄ν„° ν¬κΈ°: 100, κ²€μ¦ λ°μ΄ν„° ν¬κΈ°: 50
#1 κ²€μ¦ μ„ΈνΈ μΈλ±μ¤:[  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  50
  51  52  53  54  55  56  57  58  59  60  61  62  63  64  65  66 100 101
 102 103 104 105 106 107 108 109 110 111 112 113 114 115]

2 κµμ°¨ κ²€μ¦ μ •ν™•λ„ :0.94, ν•™μµ λ°μ΄ν„° ν¬κΈ°: 100, κ²€μ¦ λ°μ΄ν„° ν¬κΈ°: 50
#2 κ²€μ¦ μ„ΈνΈ μΈλ±μ¤:[ 17  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  67
  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82 116 117 118
 119 120 121 122 123 124 125 126 127 128 129 130 131 132]

3 κµμ°¨ κ²€μ¦ μ •ν™•λ„ :0.98, ν•™μµ λ°μ΄ν„° ν¬κΈ°: 100, κ²€μ¦ λ°μ΄ν„° ν¬κΈ°: 50
#3 κ²€μ¦ μ„ΈνΈ μΈλ±μ¤:[ 34  35  36  37  38  39  40  41  42  43  44  45  46  47  48  49  83  84
  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 133 134 135
 136 137 138 139 140 141 142 143 144 145 146 147 148 149]

## κµμ°¨ κ²€μ¦λ³„ μ •ν™•λ„: [0.98 0.94 0.98]
## ν‰κ·  κ²€μ¦ μ •ν™•λ„: 0.9666666666666667

</aside>

- 3κ°μ Stratified K ν΄λ“λ΅ κµμ°¨ κ²€μ¦ν• κ²°κ³Ό ν‰κ·  κ²€μ¦ μ •ν™•λ„κ°€ μ•½ 96.04%λ΅ μΈ΅μ •λμ—λ‹¤.
- Stratified K ν΄λ“μ κ²½μ° μ›λ³Έ λ°μ΄ν„°μ λ μ΄λΈ” λ¶„ν¬λ„ νΉμ„±μ„ λ°μν• ν•™μµ λ° κ²€μ¦ λ°μ΄ν„° μ„ΈνΈλ¥Ό λ§λ“¤ μ μμΌλ―€λ΅Β μ™κ³΅λ λ μ΄λΈ” λ°μ΄ν„° μ„ΈνΈμ—μ„λ” λ°λ“μ‹Β Stratified K ν΄λ“λ¥Ό μ΄μ©ν•΄ κµμ°¨ κ²€μ¦ν•΄μ•Ό ν•λ‹¤.
- **μ‚¬μ‹¤, μΌλ°μ μΌλ΅ λ¶„λ¥(Classification)μ—μ„μ κµμ°¨ κ²€μ¦μ€ K ν΄λ“κ°€ μ•„λ‹λΌ Stratified K ν΄λ“λ΅ λ¶„ν• λΌμ•Ό ν•λ‹¤.**

## ****cross_val_score( )****

```python
from sklearn.tree import DecisionTreeClassifier
from sklearn.model_selection import cross_val_score, cross_validate
from sklearn.datasets import load_iris

iris_data = load_iris()
dt_clf = DecisionTreeClassifier(random_state=156)

data = iris_data.data
label = iris_data.target

# μ„±λ¥ μ§€ν‘λ” μ •ν™•λ„(accuracy), κµμ°¨ κ²€μ¦ μ„ΈνΈλ” 3κ°
scores = cross_val_score(dt_clf, data, label, scoring='accuracy', cv=3)
print('κµμ°¨ κ²€μ¦λ³„ μ •ν™•λ„:', np.round(scores,4))
print('ν‰κ·  κ²€μ¦ μ •ν™•λ„:', np.round(np.mean(scores),4))
```

<aside>
<img src="https://www.notion.so/icons/playback-play_red.svg" alt="https://www.notion.so/icons/playback-play_red.svg" width="40px" /> κµμ°¨ κ²€μ¦λ³„ μ •ν™•λ„: [0.98 0.94 0.98]
ν‰κ·  κ²€μ¦ μ •ν™•λ„: 0.9667

</aside>

- cvλ΅ μ§€μ •λ νμλ§νΌ scoring νλΌλ―Έν„°λ΅ μ§€μ •λ ν‰κ°€ μ§€ν‘λ΅ ν‰κ°€ κ²°κ΄κ°’μ„ λ°°μ—΄λ΅ λ°ν™ β‡’ μΌλ°μ μΌλ΅ μ΄λ¥Ό ν‰κ· ν•΄ ν‰κ°€ μμΉλ΅ μ‚¬μ©
- λ‚΄λ¶€μ—μ„ Estimatorλ¥Ό ν•™μµ(fit), μμΈ΅(predict), ν‰κ°€(evaluation)μ‹μΌμ£Όλ―€λ΅ κ°„λ‹¨ν•κ² κµμ°¨ κ²€μ¦μ„ μν–‰ν•  μ μλ‹¤.

## GridSearchCV

### λ°μ΄ν„° λ΅λ“ & ν•™μµ λ° ν…μ¤νΈ λ°μ΄ν„° λ¶„λ¦¬

```python
from sklearn.datasets import load_iris
from sklearn.tree import DecisionTreeClassifier
from sklearn.model_selection import GridSearchCV

# λ°μ΄ν„°λ¥Ό λ΅λ”©ν•κ³  ν•™μµλ°μ΄ν„°μ™€ ν…μ¤νΈ λ°μ΄ν„° λ¶„λ¦¬
iris = load_iris()
X_train, X_test, y_train, y_test = train_test_split(iris_data.data, iris_data.target, test_size=0.2, random_state=121)
dtree = DecisionTreeClassifier()

### parameter λ“¤μ„ dictionary ν•νƒλ΅ μ„¤μ •
parameters = {'max_depth':[1,2,3], 'min_samples_split':[2,3]}
# max_depthλ” κ²°μ • νΈλ¦¬μ μµλ€ κΉμ΄λ¥Ό μ ν•ν•λ” νλΌλ―Έν„° => μ‘μ€ κ°’μΌλ΅ μ„¤μ •ν•λ©΄ λ¨λΈμ΄ λ‹¨μν™”λμ–΄ κ³Όμ ν•©μ„ μ¤„μΌ μ μκ³ , ν° κ°’μΌλ΅ μ„¤μ •ν•λ©΄ λ³µμ΅ν• λ¨λΈμ΄ λ§λ“¤μ–΄μ§ μ μμ.
# min_samples_splitμ€ λ…Έλ“λ¥Ό λ¶„ν• ν•κΈ° μ„ν•΄ ν•„μ”ν• μµμ† μƒν” μλ¥Ό μ ν•

```

- ν…μ¤νΈν•  ν•μ΄νΌ νλΌλ―Έν„° μ„ΈνΈλ” λ”•μ…”λ„λ¦¬ ν•νƒλ΅
- ν•μ΄νΌ νλΌλ―Έν„°μ λ…μΉ­μ€ λ¬Έμμ—΄ Key κ°’μΌλ΅
- ν•μ΄νΌ νλΌλ―Έν„°μ κ°’μ€ λ¦¬μ¤νΈ ν•μΌλ΅ μ„¤μ •

### ν…μ¤νΈ μν–‰ μ„¤μ • & ν•™μµ

- ν•™μµ λ°μ΄ν„° μ„ΈνΈλ¥Ό GridSearchCV κ°μ²΄μ fit(ν•™μµ λ°μ΄ν„° μ„ΈνΈ) λ©”μ„λ“μ— μΈμλ΅ μ…λ ¥ν•λ‹¤.
- ν•™μµ λ°μ΄ν„°λ¥Ό cvμ— κΈ°μ λ ν΄λ”© μ„ΈνΈλ΅ λ¶„ν• ν•΄ param_gridμ— κΈ°μ λ ν•μ΄νΌ νλΌλ―Έν„°λ¥Ό μμ°¨μ μΌλ΅ λ³€κ²½ν•λ©΄μ„ ν•™μµ/ν‰κ°€λ¥Ό μν–‰ν•κ³  κ·Έ κ²°κ³Όλ¥Ό cv_result μ†μ„±μ— κΈ°λ΅ν•λ‹¤.
- cv_result λ” gridsearchcvμ κ²°κ³Ό μ„ΈνΈλ΅μ„ λ”•μ…”λ„λ¦¬ ν•νƒλ΅ keyκ°’κ³Ό λ¦¬μ¤νΈ ν•νƒμ valueκ°’μ„ κ°€μ§„λ‹¤.

```python
import pandas as pd

# param_gridμ ν•μ΄νΌ νλΌλ―Έν„°λ“¤μ„ 3κ°μ train, test set foldλ΅ λ‚λ„μ–΄μ„ ν…μ¤νΈ μν–‰ μ„¤μ •.

grid_dtree = GridSearchCV(dtree, param_grid=parameters, cv=3, refit=True)

# iris train λ°μ΄ν„°λ΅ param_girdμ ν•μ΄νΌ νλΌλ―Έν„°λ“¤μ„ μμ°¨μ μΌλ΅ ν•™μµ/ν‰κ°€
grid_dtree.fit(X_train, y_train)

# GridSearchCV κ²°κ³Όλ¥Ό μ¶”μ¶ν•μ—¬ DataFrameμΌλ΅ λ³€ν™
scores_df = pd.DataFrame(grid_dtree.cv_results_)
scores_df[['params', 'mean_test_score', 'rank_test_score', \
         'split0_test_score', 'split1_test_score', 'split2_test_score']]
```

<aside>
<img src="https://www.notion.so/icons/playback-play_red.svg" alt="https://www.notion.so/icons/playback-play_red.svg" width="40px" />

![Untitled](Machine%20Learning%201bf9420c06824cc1bdabb2497ca8765d/Untitled%2016.png)

</aside>

- μ΄ 6κ°μ κ²°κ³Ό β‡’ ν•μ΄νΌ νλΌλ―Έν„° max_depthμ™€ min_samples_splitμ„ μμ°¨μ μΌλ΅ μ΄ 6λ² λ³€κ²½ν•λ©΄μ„ ν•™μµ λ° ν‰κ°€λ¥Ό μν–‰ν–μμ„ λ‚νƒ€λ‚Έλ‹¤.
- λ§¨ λ§μ§€λ§‰μ—μ„ λ‘ λ²μ§Έ ν–‰μ„ λ³΄λ©΄ ν‰κ°€ν• κ²°κ³Ό μμΈ΅ μ„±λ¥μ΄ 1μ„λΌλ” μλ―Έ
- split0_test_score, split1_test_score, split2_test_scoreλ” CVκ°€ 3μΈ κ²½μ°, μ¦‰ 3κ°μ ν΄λ”© μ„ΈνΈμ—μ„ κ°κ° ν…μ¤νΈν• μ„±λ¥ μμΉ
- mean_test_scoreλ” μ΄ μ„Έ κ° μ„±λ¥ μμΉλ¥Ό ν‰κ· ν™”ν• κ²ƒ

<aside>
π’΅

- params μΉΌλΌμ—λ” μν–‰ν•  λ•λ§λ‹¤ μ μ©λ κ°λ³„ ν•μ΄νΌ νλΌλ―Έν„° κ°’μ„ λ‚νƒ€λ‚Έλ‹¤.
- rank_test_scoreλ” ν•μ΄νΌ νλΌλ―Έν„°λ³„λ΅ μ„±λ¥μ΄ μΆ‹μ€ score μμ„λ¥Ό λ‚νƒ€λ‚Έλ‹¤.
- mean_test_scoreλ” κ°λ³„ ν•μ΄νΌ νλΌλ―Έν„°λ³„λ΅ CVμ ν΄λ”© ν…μ¤νΈ μ„ΈνΈμ— λ€ν•΄ μ΄ μν–‰ν• ν‰κ°€ ν‰κ· κ°’μ΄λ‹¤.
</aside>

### μµμ  νλΌλ―Έν„° & μµκ³  μ •ν™•λ„ λ„μ¶

- GridSearchCV κ°μ²΄μ fit( )μ„ μν–‰ν•λ©΄ μµκ³  μ„±λ¥μ„ λ‚νƒ€λ‚Έ ν•μ΄νΌ νλΌλ―Έν„° κ°’κ³Ό κ·Έλ•μ ν‰κ°€ κ²°κ³Ό κ°’μ΄ κ°κ° best_params, best_score_μ†μ„±μ— κΈ°λ΅λλ‹¤.

```python
print('GridSearchCV μµμ  νλΌλ―Έν„°:', grid_dtree.best_params_)
print('GridSearchCV μµκ³  μ •ν™•λ„:{0:4f}'.format(grid_dtree.best_score_))
```

<aside>
<img src="https://www.notion.so/icons/playback-play_red.svg" alt="https://www.notion.so/icons/playback-play_red.svg" width="40px" /> GridSearchCV μµμ  νλΌλ―Έν„°: {'max_depth': 3, 'min_samples_split': 2}
GridSearchCV μµκ³  μ •ν™•λ„:0.975000

</aside>

```python
# refit=Trueλ΅ μ„¤μ •λ GridSearchCV κ°μ²΄κ°€ fit()λ¥Ό μν–‰μ‹ ν•™μµμ΄ μ™„λ£λ Estimatorλ¥Ό λ‚΄ν¬ν•κ³  μμΌλ―€λ΅ predict()μ„ ν†µν•΄ μμΈ΅λ„ κ°€λ¥

pred = grid_dtree.predict(X_test)
print('ν…μ¤νΈ λ°μ΄ν„° μ„ΈνΈ μ •ν™•λ„: {0:.4f}'.format(accuracy_score(y_test,pred)))
```

<aside>
<img src="https://www.notion.so/icons/playback-play_red.svg" alt="https://www.notion.so/icons/playback-play_red.svg" width="40px" /> ν…μ¤νΈ λ°μ΄ν„° μ„ΈνΈ μ •ν™•λ„: 0.9667

</aside>

<aside>
π’΅ μΌλ°μ μΌλ΅ ν•™μµ λ°μ΄ν„°λ¥Ό GridSearchCVλ¥Ό μ΄μ©ν•΄ μµμ  ν•μ΄νΌ νλΌλ―Έν„° νλ‹μ„ μν–‰ν• λ’¤μ— λ³„λ„μ ν…μ¤νΈ μ„ΈνΈμ—μ„ μ΄λ¥Ό ν‰κ°€ν•λ” κ²ƒμ΄ μΌλ°μ μΈ λ¨Έμ‹ λ¬λ‹ λ¨λΈ μ μ© λ°©λ²•μ΄λ‹¤.

</aside>